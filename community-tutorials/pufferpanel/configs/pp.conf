<VirtualHost *:80>
    ServerName pp.example.com
    Redirect permanent / https://pp.example.com/
	Protocols h2 h2c http/1.1
    ErrorLog /var/log/apache2/pp.error.log
</VirtualHost>

<VirtualHost *:443>
    ServerName pp.example.com

        ProxyPreserveHost On
        SSLProxyEngine On
        ProxyPass / http://localhost:8080/
        ProxyPassReverse / http://localhost:8080/

        RewriteEngine on
        RewriteCond %{HTTP:Upgrade} websocket [NC]
        RewriteCond %{HTTP:Connection} upgrade [NC]
        RewriteRule .* ws://localhost:8080%{REQUEST_URI} [P]

	Protocols h2 h2c http/1.1
    ErrorLog /var/log/apache2/pp.error.log
SSLCertificateFile /etc/letsencrypt/live/pp.example.com/fullchain.pem
SSLCertificateKeyFile /etc/letsencrypt/live/pp.example.com/privkey.pem
</VirtualHost>
